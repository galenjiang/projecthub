var page=new Vue({el:"#page",data:{userdata:{header_url:""},infoShow:!0,inputShow:!1,type:0,changedNickname:"",changedSex:"",changedBirthday:"",changedHeader_url:"",pageTransitonType:"mui-tabview-l2r",slideTransitionType:"mui-tabview-l2r",fastClick:!0},computed:{maleClassObj:function(){return{"mui-icon-xuanzhong":1==this.changedSex,"mui-icon-weixuan":1!=this.changedSex}},femaleClassObj:function(){return{"mui-icon-xuanzhong":2==this.changedSex,"mui-icon-weixuan":2!=this.changedSex}},sex:function(){var t="";switch(this.userdata.sex){case"1":t="男";break;case"2":t="女";break;default:t="未知"}return t},nicknameObj:function(){return{display:"昵称"==this.type?"block":"none"}},sexObj:function(){return{display:"性别"==this.type?"block":"none"}},birthdayObj:function(){return{display:"出生年月"==this.type?"block":"none"}}},methods:{init:function(t){Vue.http.get(url+"index.php?m=Api&c=User&a=UserInfo",{}).then(function(i){1==i.data.status?(this.userdata=_.assign({},this.userdata,_.mapValues(i.data.data,function(t){return t})),t&&t(),localStorage.userdata=JSON.stringify(this.userdata)):Mui.message.toast({msg:i.data.info})}.bind(this))["catch"](function(t){alert(t)})},uploadHead:function(){wx.ready(function(){wx.chooseImage({count:1,success:function(t){util.console.log(t.localIds),wx.uploadImage({localId:t.localIds[0],isShowProgressTips:1,success:function(t){var i=t.serverId;Vue.http.get(url+"index.php?m=Home&c=Demo&a=getImg",{MediaId:i}).then(function(t){return this.headimg=t.data,Vue.http.get(url+"index.php?m=Api&c=User&a=modifyUserInfo",{header_url:t.data,key:"header_url"})}.bind(this)).then(function(t){1==t.data.status?(this.userdata.header_url=this.headimg,this.updateUserInfo()):Mui.message.toast({msg:t.data.info})}.bind(this))["catch"](function(t){alert(4+JSON.stringify(t))})}.bind(this)})}.bind(this)})}.bind(this))},change:function(t){util.console.log(t),this.type=t,this.infoShow=!1,this.inputShow=!0,this.pageTransitonType="mui-tabview-r2l",this.slideTransitionType="mui-tabview-r2l"},inputBack:function(){this.infoShow=!0,this.inputShow=!1,this.pageTransitonType="mui-tabview-l2r",this.slideTransitionType="mui-tabview-l2r",event.preventDefault()},save:function(){var t={nickname:this.changedNickname,sex:this.changedSex,birthday:this.changedBirthday},i="";switch(this.type){case"昵称":i="nickname";break;case"性别":i="sex";break;case"出生年月":i="birthday";break;default:return!1}t.key=i,this.fastClick&&(this.fastClick=!1,Vue.http.get(url+"index.php?m=Api&c=User&a=modifyUserInfo",t).then(function(t){this.fastClick=!0,1==t.data.status?(this.init(),this.inputBack()):Mui.message.toast({msg:t.data.info})}.bind(this))["catch"](function(t){this.fastClick=!0,alert(t)}.bind(this)))},change2male:function(){this.changedSex=1},change2female:function(){this.changedSex=2}},created:function(){this.init(function(){switch(this.changedNickname=this.userdata.nickname,this.changedBirthday=this.userdata.birthday,this.sex){case"男":this.changedSex=1;break;case"女":this.changedSex=2;break;default:this.changedSex=1}}.bind(this))},beforeCompile:function(){this.userdata=util.init(),util.geograph(function(){this.userdata=util.init(),this.init(function(){switch(this.changedNickname=this.userdata.nickname,this.changedBirthday=this.userdata.birthday,this.sex){case"男":this.changedSex=1;break;case"女":this.changedSex=2;break;default:this.changedSex=1}}.bind(this))}.bind(this))},ready:function(){}});